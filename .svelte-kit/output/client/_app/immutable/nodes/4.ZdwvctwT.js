import{t as g,a as m}from"../chunks/CMXY7JCy.js";import"../chunks/Dyuw9cGK.js";import{h as B,az as ce,aA as ve,a8 as ue,aB as de,aC as fe,aD as _e,V as pe,aE as me,aF as Y,c as x,g as s,s as k,r as z,t as T,p as ge,a as he,m as L,b as P,a0 as be,aG as C}from"../chunks/mdvGq3lZ.js";import{a as ke,l as Q,s as W,e as w,r as ye}from"../chunks/DOFgpHCO.js";import{i as ze,p as Se,a as A,s as xe,b as Ae}from"../chunks/CgZkDfG6.js";import{e as X,i as Z}from"../chunks/C0X1WQSd.js";import{i as $e}from"../chunks/DQYTF5hf.js";import{o as F}from"../chunks/CWuZ4Z7h.js";import{s as Ie}from"../chunks/3pXMxo2Z.js";const Ne=Symbol("is custom element"),Pe=Symbol("is html");function we(e){if(B){var a=!1,t=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var n=e.value;V(e,"value",null),e.value=n}if(e.hasAttribute("checked")){var o=e.checked;V(e,"checked",null),e.checked=o}}};e.__on_r=t,ce(t),ke()}}function V(e,a,t,n){var o=Te(e);B&&(o[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||o[a]!==(o[a]=t)&&(a==="loading"&&(e[de]=t),t==null?e.removeAttribute(a):typeof t!="string"&&je(e).includes(a)?e[a]=t:e.setAttribute(a,t))}function Te(e){return e.__attributes??(e.__attributes={[Ne]:e.nodeName.includes("-"),[Pe]:e.namespaceURI===ve})}var G=new Map;function je(e){var a=G.get(e.nodeName);if(a)return a;G.set(e.nodeName,a=[]);for(var t,n=e,o=Element.prototype;o!==n;){t=fe(n);for(var r in t)t[r].set&&a.push(r);n=ue(n)}return a}function R(e,a,t=a){var n=_e();Q(e,"input",o=>{var r=o?e.defaultValue:e.value;if(r=q(e)?D(r):r,t(r),n&&r!==(r=a())){var l=e.selectionStart,v=e.selectionEnd;e.value=r??"",v!==null&&(e.selectionStart=l,e.selectionEnd=Math.min(v,e.value.length))}}),(B&&e.defaultValue!==e.value||pe(a)==null&&e.value)&&t(q(e)?D(e.value):e.value),me(()=>{var o=a();q(e)&&o===D(e.value)||e.type==="date"&&!o&&!e.value||o!==e.value&&(e.value=o??"")})}function q(e){var a=e.type;return a==="number"||a==="range"}function D(e){return e===""?null:+e}function ee(e,a,t){if(e.multiple)return Ee(e,a);for(var n of e.options){var o=$(n);if(ze(o,a)){n.selected=!0;return}}(!t||a!==void 0)&&(e.selectedIndex=-1)}function Me(e,a){Y(()=>{var t=new MutationObserver(()=>{var n=e.__value;ee(e,n)});return t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function Oe(e,a,t=a){var n=!0;Q(e,"change",o=>{var r=o?"[selected]":":checked",l;if(e.multiple)l=[].map.call(e.querySelectorAll(r),$);else{var v=e.querySelector(r)??e.querySelector("option:not([disabled])");l=v&&$(v)}t(l)}),Y(()=>{var o=a();if(ee(e,o,n),n&&o===void 0){var r=e.querySelector(":checked");r!==null&&(o=$(r),t(o))}e.__value=o,n=!1}),Me(e)}function Ee(e,a){for(var t of e.options)t.selected=~a.indexOf($(t))}function $(e){return"__value"in e?e.__value:e.value}const He=()=>{const e=Ie;return{page:{subscribe:e.page.subscribe},navigating:{subscribe:e.navigating.subscribe},updated:e.updated}},Le={subscribe(e){return He().page.subscribe(e)}};var Ce=g("<img>"),qe=g("<p> </p>"),De=g("<div><!> <!></div>"),Ve=g("<section></section>");function Be(e,a){let t=Se(a,"slides",24,()=>[]);var n=Ve();X(n,5,t,Z,(o,r)=>{var l=De(),v=x(l);{var I=u=>{var d=Ce();T(()=>V(d,"src",`/images/${s(r).presentationId}/${s(r).imagePath}`)),m(u,d)};A(v,u=>{s(r).imagePath&&u(I)})}var N=k(v,2);{var j=u=>{var d=qe(),S=x(d,!0);z(d),T(()=>W(S,s(r).content)),m(u,d)};A(N,u=>{s(r).content&&u(j)})}z(l),m(o,l)}),z(n),m(e,n)}var Je=g("<input>"),Ke=g("<textarea></textarea>"),Ue=g("<div><!> <!></div>"),Fe=g("<select><option>Csak sz√∂veg</option><option>Csak k√©p</option><option>Sz√∂veg + K√©p</option><option>K√©p + Sz√∂veg</option></select> <button>‚ûï √öj dia hozz√°ad√°sa</button> <!>",1),Ge=g("<section><button> </button> <!></section>");function oa(e,a){ge(a,!1);const[t,n]=xe(),o=()=>Ae(Le,"$page",t);let r=L([]),l=L("text"),v=L(!1),I;async function N(){var h;const i=(h=o().params)==null?void 0:h.id;if(!i){console.error("‚ùå HIBA: A `presentationId` √ºres vagy undefined!"),alert("Nem tal√°lhat√≥ a prezent√°ci√≥ azonos√≠t√≥!");return}console.log(`üìå Lek√©rdezz√ºk a di√°k list√°j√°t: /api/presentations/${i}/slides`);try{const c=await fetch(`/api/presentations/${i}/slides`);if(!c.ok){const _=await c.json();console.error("‚ö†Ô∏è API hiba:",_),alert(`Hiba t√∂rt√©nt a di√°k lek√©r√©sekor: ${_.error}`);return}const f=await c.json();console.log("üìå Sikeres v√°lasz a szervert≈ël:",f),Array.isArray(f.slides)?P(r,[...f.slides]):(console.error("‚ö†Ô∏è V√°ratlan API v√°lasz:",f),alert("A szerver nem megfelel≈ë form√°tum√∫ adatot k√ºld√∂tt!"))}catch(c){console.error("‚ö†Ô∏è H√°l√≥zati hiba:",c),alert("Nem siker√ºlt kapcsol√≥dni a szerverhez!")}}F(()=>{console.log("üìå Oldal bet√∂ltve, di√°k lek√©r√©se..."),N()});async function j(){const i=o().params.id;if(!i){console.error("‚ùå HIBA: Nincs Presentation ID!"),alert("Nem tal√°lhat√≥ a prezent√°ci√≥ azonos√≠t√≥!");return}const h={presentationId:i,content:s(l)==="text"||s(l)==="text-image"?"√öj sz√∂veg":null,imagePath:s(l)==="image"||s(l)==="image-text"?"default.png":null};console.log("üìå √öj dia k√ºld√©se:",JSON.stringify(h));try{const c=await fetch(`/api/presentations/${i}/slides`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)});if(!c.ok){const _=await c.json();console.error("‚ö†Ô∏è API hiba:",_),alert(`Hiba t√∂rt√©nt a dia hozz√°ad√°sakor: ${_.error}`);return}const f=await c.json();P(r,[...s(r),f.slide])}catch(c){console.error("‚ö†Ô∏è H√°l√≥zati hiba:",c),alert("Nem siker√ºlt kapcsol√≥dni a szerverhez!")}}async function u(i){clearTimeout(I),I=setTimeout(async()=>{await fetch(`/api/presentations/${i.presentationId}/slides/${i.id}`,{method:"PUT",body:JSON.stringify(i),headers:{"Content-Type":"application/json"}})},3e3)}F(N),$e();var d=Ge(),S=x(d),ae=x(S,!0);z(S);var te=k(S,2);{var re=i=>{var h=Fe(),c=be(h);T(()=>{s(l),C(()=>{})});var f=x(c);f.value=(f.__value="text")==null?"":"text";var _=k(f);_.value=(_.__value="image")==null?"":"image";var M=k(_);M.value=(M.__value="text-image")==null?"":"text-image";var J=k(M);J.value=(J.__value="image-text")==null?"":"image-text",z(c);var K=k(c,2),se=k(K,2);X(se,1,()=>s(r),Z,(O,b,Re)=>{var E=Ue(),U=x(E);{var ne=y=>{var p=Je();we(p),R(p,()=>s(b).imagePath,H=>(s(b).imagePath=H,C(()=>s(r)))),w("input",p,()=>u(s(b))),m(y,p)};A(U,y=>{s(b).imagePath!==null&&y(ne)})}var ie=k(U,2);{var le=y=>{var p=Ke();ye(p),R(p,()=>s(b).content,H=>(s(b).content=H,C(()=>s(r)))),w("input",p,()=>u(s(b))),m(y,p)};A(ie,y=>{s(b).content!==null&&y(le)})}z(E),m(O,E)}),Oe(c,()=>s(l),O=>P(l,O)),w("click",K,j),m(i,h)},oe=i=>{Be(i,{get slides(){return s(r)}})};A(te,i=>{s(v)?i(oe,!1):i(re)})}z(d),T(()=>W(ae,s(v)?"Szerkeszt≈ë n√©zet":"Prezent√°ci√≥ n√©zet")),w("click",S,()=>P(v,!s(v))),m(e,d),he(),n()}export{oa as component};
